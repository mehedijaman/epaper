import{d as _t,I as ue,o as u,c as v,a as s,e as n,f as e,w as r,J as c,K as g,F as R,L as J,k as _,n as te,j as M,l as ct,G as Ne,O as yt,x as $,p,z as ae,h as ht,M as pt}from"./app-BIDwooZD.js";import{_ as ft}from"./ConfirmActionDialog.vue_vue_type_script_setup_true_lang-C7nxwQ1e.js";import{T as xt,_ as Et,P as $t}from"./EditionContextBar.vue_vue_type_script_setup_true_lang-BA6c6IMC.js";import{_ as De,a as we}from"./index-CR_w27Kk.js";import{_ as Ce}from"./AlertTitle.vue_vue_type_script_setup_true_lang-C9ceEc2p.js";import{_ as Pe}from"./index-Y7wIGGvX.js";import{_ as C}from"./index-C8P2q1AW.js";import{_ as je,a as Ae,b as Re,c as Le,d as W}from"./SelectValue.vue_vue_type_script_setup_true_lang-CtmDDGDY.js";import{C as Fe}from"./circle-alert-D7cxjvWW.js";import{L as mt}from"./loader-circle-DZmtfIFJ.js";import{_ as at,a as gt,b as vt,c as nt}from"./CardTitle.vue_vue_type_script_setup_true_lang-ChP2b989.js";import{_ as st,a as lt,b as it,c as rt,d as ot}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DvCkWFlb.js";import{_ as dt}from"./DialogFooter.vue_vue_type_script_setup_true_lang-Cg5QyE-8.js";import{_ as de}from"./Input.vue_vue_type_script_setup_true_lang-B1SXL9YZ.js";import{_ as kt}from"./EpAdminLayout.vue_vue_type_script_setup_true_lang-C7XcxSU8.js";import{G as St}from"./grip-vertical-oZORia1F.js";import"./createLucideIcon-ccUrNrU9.js";import"./Primitive-BLKkOots.js";import"./useForwardPropsEmits-ljZNR3_O.js";import"./VisuallyHidden-Cp8joezf.js";import"./chevron-right-CAogZLbH.js";import"./check-BMDuJIhl.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./useFormControl-DzJJrvcL.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-DSMqO86V.js";import"./RovingFocusGroup-CSddD9ru.js";import"./newspaper-BTZbB5ry.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-rq6uf0wM.js";const Dt={class:"space-y-4 rounded-xl border border-border/70 bg-card p-4 shadow-sm"},wt={class:"flex flex-wrap items-start justify-between gap-2"},Ct={class:"grid gap-3 md:grid-cols-2"},Ft={class:"space-y-2"},Nt={class:"space-y-2"},Pt={key:0,class:"text-xs text-destructive"},Mt=["aria-disabled","onKeydown"],zt={class:"text-sm font-semibold"},Ut={class:"mt-1 text-xs text-muted-foreground"},It={class:"mt-3 flex flex-wrap items-center justify-center gap-2"},Tt={class:"list-disc pl-4"},Vt={class:"list-disc pl-4"},Bt={class:"list-disc pl-4"},Ot={key:4,class:"space-y-3"},jt={class:"grid gap-2 sm:grid-cols-4"},At={class:"rounded-md border border-border/70 bg-muted/20 p-3 text-xs"},Rt={class:"mt-1 text-muted-foreground"},Lt={class:"rounded-md border border-border/70 bg-muted/20 p-3 text-xs"},Kt={class:"mt-1 text-muted-foreground"},Gt={class:"rounded-md border border-border/70 bg-muted/20 p-3 text-xs"},qt={class:"mt-1 text-muted-foreground"},Ht={class:"rounded-md border border-border/70 bg-muted/20 p-3 text-xs"},Jt={class:"mt-1 text-muted-foreground"},Wt={key:0,class:"text-sm text-destructive"},Zt={class:"max-h-64 space-y-1 overflow-y-auto rounded-md border border-border/70 bg-muted/20 p-2 text-xs"},Xt={class:"min-w-0 flex-1"},Yt={class:"truncate font-medium"},Qt={class:"text-muted-foreground"},ea={class:"shrink-0 text-right"},ta={class:"font-medium"},aa={class:"list-disc pl-4"},na={key:6,class:"space-y-2 rounded-md border border-border/70 bg-muted/20 p-3"},sa={class:"flex items-center justify-between text-xs text-muted-foreground"},la={class:"inline-flex items-center gap-1"},ia={class:"h-2 w-full overflow-hidden rounded bg-muted"},ra={class:"flex flex-wrap justify-end gap-2"},oa=_t({__name:"MultiPageUploadForm",props:{editionId:{},categories:{},existingPageNumbers:{},uploadConstraints:{}},emits:["uploaded"],setup(Ke,{emit:m}){const S=Ke,U=m,D=$([]),Z=$(null),A=$(0),O=$(!1),T=$([]),w=new Set(["jpg","jpeg","png","webp"]),X=new Set(["image/jpg","image/jpeg","image/png","image/webp"]),f=ue({edition_id:S.editionId,category_id:null,page_no_strategy:"auto",files:[]}),Y=p({get:()=>typeof f.category_id!="number"||!Number.isFinite(f.category_id)||f.category_id<=0?"none":String(f.category_id),set:i=>{if(i==="none"){f.category_id=null;return}const a=Number.parseInt(i,10);f.category_id=Number.isFinite(a)&&a>0?a:null}}),ne=p(()=>new Set(S.existingPageNumbers)),se=p(()=>S.existingPageNumbers.length===0?0:Math.max(...S.existingPageNumbers)),G=p(()=>{const i=Number.isFinite(S.uploadConstraints.maxFiles)?Math.trunc(S.uploadConstraints.maxFiles):200;return Math.max(1,i)}),Me=p(()=>{const i=Number.isFinite(S.uploadConstraints.maxFileSizeKb)?Math.trunc(S.uploadConstraints.maxFileSizeKb):15360;return Math.max(1,i)}),le=p(()=>Me.value*1024),V=p(()=>{const i=Number.isFinite(S.uploadConstraints.serverUploadMaxBytes)?Math.trunc(S.uploadConstraints.serverUploadMaxBytes):0;return Math.max(0,i)}),L=p(()=>{const i=Number.isFinite(S.uploadConstraints.serverPostMaxBytes)?Math.trunc(S.uploadConstraints.serverPostMaxBytes):0;return Math.max(0,i)}),K=p(()=>{const i=Number.isFinite(S.uploadConstraints.serverMaxFileUploads)?Math.trunc(S.uploadConstraints.serverMaxFileUploads):0;return i<=0?G.value:i}),N=p(()=>Math.max(1,Math.min(G.value,K.value))),j=p(()=>V.value<=0?le.value:Math.max(1,Math.min(le.value,V.value))),B=p(()=>D.value.length>0&&D.value.every(i=>oe(i.name)!==null)),P=p(()=>f.page_no_strategy==="next_available"?"next_available":f.page_no_strategy==="filename"?B.value?"filename":"filename_invalid":B.value?"filename":"next_available"),b=p(()=>P.value==="filename"?Ve(D.value):[...D.value]),z=p(()=>{if(b.value.length===0)return[];if(P.value==="filename_invalid")return[];if(P.value==="filename"){const a=oe(b.value[0]?.name??"")??1,d=Math.max(1,a);return b.value.map((h,k)=>d+k)}const i=se.value+1;return b.value.map((a,d)=>i+d)}),y=p(()=>z.value.filter(i=>ne.value.has(i))),F=p(()=>b.value.map((i,a)=>{const d=z.value[a]??null,h=d!==null&&ne.value.has(d);return{fileKey:me(i),fileName:i.name,fileSizeText:re(i.size),targetPageNo:d,replacesExisting:h}})),I=p(()=>P.value==="filename"?"Filename prefix order":P.value==="next_available"?"Next available page numbers":"Filename prefixes required"),Q=p(()=>{if(z.value.length===0)return null;const i=z.value[0],a=z.value[z.value.length-1];return i===void 0||a===void 0?null:i===a?`Page ${i}`:`Pages ${i} to ${a}`}),ce=p(()=>D.value.length>0),q=p(()=>D.value.reduce((i,a)=>i+a.size,0)),xe=p(()=>re(q.value)),pe=p(()=>`${D.value.length} ${ie(D.value.length,"file","files")}`),fe=p(()=>y.value.length>0),Ge=p(()=>{if(!fe.value)return"";const i=y.value.slice(0,10),a=y.value.length>i.length?", ...":"";return`${i.join(", ")}${a}`}),ze=p(()=>re(j.value)),be=p(()=>L.value>0?re(L.value):"Unknown"),Ue=p(()=>{const i=[];return L.value>0&&i.push(`Server request limit: ${be.value}`),V.value>0&&i.push(`Server per-file limit: ${re(V.value)}`),K.value>0&&i.push(`Server max files/request: ${K.value}`),i}),ye=p(()=>{if(!ce.value)return[];const i=[],a=D.value.filter(d=>d.size>j.value);return a.length>0&&i.push(`${a.length} ${ie(a.length,"file exceeds","files exceed")} the per-file server limit of ${ze.value}.`),L.value>0&&q.value>L.value&&i.push(`Selected batch size (${xe.value}) exceeds current server request limit (${be.value}).`),i}),Ie=p(()=>f.processing||D.value.length===0||ye.value.length>0?!1:P.value!=="filename_invalid"),he=p(()=>Math.max(0,Math.min(100,Math.round(f.progress?.percentage??0)))),qe=p(()=>f.processing?`Uploading ${he.value}%`:"Upload pages"),Te=p(()=>{const i=[];for(const[a,d]of Object.entries(f.errors))(a==="files"||a.startsWith("files.")||a==="edition_id")&&typeof d=="string"&&d.trim()!==""&&i.push(d);return Array.from(new Set(i))});function ie(i,a,d){return i===1?a:d}function me(i){return`${i.name}::${i.size}::${i.lastModified}`}function re(i){if(!Number.isFinite(i)||i<=0)return"0 B";const a=["B","KB","MB","GB"];let d=i,h=0;for(;d>=1024&&h<a.length-1;)d/=1024,h+=1;const k=h===0?0:2;return`${d.toFixed(k)} ${a[h]}`}function He(i){const a=i.lastIndexOf(".");return a<0||a===i.length-1?"":i.slice(a+1).toLowerCase()}function Je(i){const a=He(i.name);return w.has(a)?!0:X.has(i.type.toLowerCase())}function Ee(i,a){const d=new Map;for(const k of i)d.set(me(k),k);let h=0;for(const k of a){const H=me(k);if(d.has(H)){h+=1;continue}d.set(H,k)}return{files:Array.from(d.values()),duplicatesSkipped:h}}function oe(i){const a=i.lastIndexOf("."),d=a>0?i.slice(0,a):i,h=/^(\d+)/.exec(d);return h===null?null:Number.parseInt(h[1],10)}function Ve(i){return[...i].sort((a,d)=>{const h=oe(a.name),k=oe(d.name);return h!==k?(h??Number.MAX_SAFE_INTEGER)-(k??Number.MAX_SAFE_INTEGER):a.name.localeCompare(d.name,void 0,{sensitivity:"base"})})}function ge(i,a){const d=a?.append===!0;if(d&&i.length===0)return;const h=d?Ee(D.value,i):{files:i,duplicatesSkipped:0},k=[],H=[];for(const Se of h.files){if(Je(Se)){k.push(Se);continue}H.push(Se.name)}let Oe=0,ke=k;k.length>N.value&&(Oe=k.length-N.value,ke=k.slice(0,N.value)),D.value=ke,f.files=ke,ve();const _e=[];h.duplicatesSkipped>0&&_e.push(`${h.duplicatesSkipped} duplicate ${ie(h.duplicatesSkipped,"file was","files were")} skipped.`),H.length>0&&_e.push(`${H.length} unsupported ${ie(H.length,"file was","files were")} ignored. Use JPG, JPEG, PNG, or WEBP.`),Oe>0&&_e.push(`Only the first ${N.value} files were kept for this upload.`),T.value=_e}function ve(){f.clearErrors()}function We(i){if(f.processing)return;const a=i.target;ge(Array.from(a.files??[]),{append:!0}),a.value=""}function ee(){f.processing||Z.value?.click()}function Be(){f.processing||(O.value=!0)}function Ze(i){f.processing||(O.value=!0,i.dataTransfer!==null&&(i.dataTransfer.dropEffect="copy"))}function Xe(i){if(f.processing)return;const a=i.currentTarget,d=i.relatedTarget;a instanceof HTMLElement&&d instanceof Node&&a.contains(d)||(O.value=!1)}function Ye(i){f.processing||(O.value=!1,ge(Array.from(i.dataTransfer?.files??[]),{append:!0}))}function Qe(){f.processing||(ge([]),T.value=[],A.value+=1)}function $e(i){if(f.processing)return;const a=D.value.filter(d=>me(d)!==i);ge(a),A.value+=1}function et(){if(Ie.value){if(S.editionId<=0){f.setError("edition_id","Select an edition before uploading.");return}f.edition_id=S.editionId,f.files=b.value,ve(),T.value=[],f.post("/admin/pages/upload",{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{f.reset("files"),D.value=[],T.value=[],A.value+=1,U("uploaded")}})}}return(i,a)=>(u(),v("div",Dt,[s("div",wt,[a[2]||(a[2]=s("div",{class:"space-y-1"},[s("h3",{class:"text-base font-semibold"},"Upload pages"),s("p",{class:"text-xs text-muted-foreground"}," Drop images, preview target page numbers, and check replacement conflicts before upload. ")],-1)),n(e(Pe),{variant:e(f).processing?"secondary":"outline",class:"capitalize"},{default:r(()=>[c(g(e(f).processing?"Uploading in progress":"Ready for upload"),1)]),_:1},8,["variant"])]),s("div",Ct,[s("div",Ft,[a[6]||(a[6]=s("label",{class:"text-sm font-medium"},"Page number strategy",-1)),n(e(je),{modelValue:e(f).page_no_strategy,"onUpdate:modelValue":a[0]||(a[0]=d=>e(f).page_no_strategy=d)},{default:r(()=>[n(e(Ae),{disabled:e(f).processing},{default:r(()=>[n(e(Re),{placeholder:"Select strategy"})]),_:1},8,["disabled"]),n(e(Le),null,{default:r(()=>[n(e(W),{value:"auto"},{default:r(()=>[...a[3]||(a[3]=[c("Auto",-1)])]),_:1}),n(e(W),{value:"filename"},{default:r(()=>[...a[4]||(a[4]=[c("Filename (01.jpg, 02.jpg)",-1)])]),_:1}),n(e(W),{value:"next_available"},{default:r(()=>[...a[5]||(a[5]=[c("Next available",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),s("div",Nt,[a[8]||(a[8]=s("label",{class:"text-sm font-medium"},"Category",-1)),n(e(je),{modelValue:Y.value,"onUpdate:modelValue":a[1]||(a[1]=d=>Y.value=d)},{default:r(()=>[n(e(Ae),{disabled:e(f).processing},{default:r(()=>[n(e(Re),{placeholder:"Select category"})]),_:1},8,["disabled"]),n(e(Le),null,{default:r(()=>[n(e(W),{value:"none"},{default:r(()=>[...a[7]||(a[7]=[c("Uncategorized",-1)])]),_:1}),(u(!0),v(R,null,J(S.categories,d=>(u(),M(e(W),{key:d.id,value:String(d.id)},{default:r(()=>[c(g(d.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(f).errors.category_id?(u(),v("p",Pt,g(e(f).errors.category_id),1)):_("",!0)])]),(u(),v("input",{key:A.value,ref_key:"fileInputRef",ref:Z,type:"file",class:"sr-only",accept:"image/*",multiple:"",onChange:We},null,32)),s("div",{role:"button",tabindex:"0",class:Ne(["rounded-xl border-2 border-dashed px-4 py-8 text-center transition-colors",O.value?"border-primary bg-primary/10":"border-slate-300 bg-slate-50/80 hover:border-primary/70 hover:bg-primary/5"]),"aria-disabled":e(f).processing,onClick:ee,onKeydown:[ct(te(ee,["prevent"]),["enter"]),ct(te(ee,["prevent"]),["space"])],onDragenter:te(Be,["prevent"]),onDragover:te(Ze,["prevent"]),onDragleave:te(Xe,["prevent"]),onDrop:te(Ye,["prevent"])},[s("p",zt,g(O.value?"Release to add files":"Drop image files here or click to browse"),1),s("p",Ut," Supported: JPG, JPEG, PNG, WEBP · Max "+g(ze.value)+" each · Up to "+g(N.value)+" files · Request up to "+g(be.value),1),s("div",It,[n(e(C),{size:"sm",variant:"secondary",disabled:e(f).processing,onClick:te(ee,["stop"])},{default:r(()=>[...a[9]||(a[9]=[c(" Browse files ",-1)])]),_:1},8,["disabled"]),ce.value?(u(),M(e(C),{key:0,size:"sm",variant:"outline",disabled:e(f).processing,onClick:te(Qe,["stop"])},{default:r(()=>[...a[10]||(a[10]=[c(" Clear all ",-1)])]),_:1},8,["disabled"])):_("",!0)])],42,Mt),a[22]||(a[22]=s("p",{class:"text-[11px] text-muted-foreground"}," Tip: drag and drop multiple times to keep adding files to the same upload batch. ",-1)),Ue.value.length>0?(u(),M(e(we),{key:0},{default:r(()=>[n(e(Fe),{class:"size-4"}),n(e(Ce),null,{default:r(()=>[...a[11]||(a[11]=[c("Current server limits",-1)])]),_:1}),n(e(De),null,{default:r(()=>[s("ul",Tt,[(u(!0),v(R,null,J(Ue.value,d=>(u(),v("li",{key:d},g(d),1))),128))])]),_:1})]),_:1})):_("",!0),T.value.length>0?(u(),M(e(we),{key:1,class:"border-amber-500/40 text-amber-800"},{default:r(()=>[n(e(Fe),{class:"size-4"}),n(e(Ce),null,{default:r(()=>[...a[12]||(a[12]=[c("Selection notice",-1)])]),_:1}),n(e(De),null,{default:r(()=>[s("ul",Vt,[(u(!0),v(R,null,J(T.value,d=>(u(),v("li",{key:d},g(d),1))),128))])]),_:1})]),_:1})):_("",!0),ye.value.length>0?(u(),M(e(we),{key:2,variant:"destructive"},{default:r(()=>[n(e(Fe),{class:"size-4"}),n(e(Ce),null,{default:r(()=>[...a[13]||(a[13]=[c("Selection exceeds server limits",-1)])]),_:1}),n(e(De),null,{default:r(()=>[s("ul",Bt,[(u(!0),v(R,null,J(ye.value,d=>(u(),v("li",{key:d},g(d),1))),128))])]),_:1})]),_:1})):_("",!0),fe.value?(u(),M(e(we),{key:3,class:"border-amber-500/40 text-amber-800"},{default:r(()=>[n(e(Fe),{class:"size-4"}),n(e(Ce),null,{default:r(()=>[...a[14]||(a[14]=[c("Existing pages will be replaced",-1)])]),_:1}),n(e(De),null,{default:r(()=>[c(" Conflicting page numbers: "+g(Ge.value),1)]),_:1})]),_:1})):_("",!0),ce.value?(u(),v("div",Ot,[s("div",jt,[s("div",At,[a[15]||(a[15]=s("p",{class:"font-medium text-foreground"},"Selected files",-1)),s("p",Rt,g(pe.value),1)]),s("div",Lt,[a[16]||(a[16]=s("p",{class:"font-medium text-foreground"},"Total size",-1)),s("p",Kt,g(xe.value),1)]),s("div",Gt,[a[17]||(a[17]=s("p",{class:"font-medium text-foreground"},"Effective strategy",-1)),s("p",qt,g(I.value),1)]),s("div",Ht,[a[18]||(a[18]=s("p",{class:"font-medium text-foreground"},"Target range",-1)),s("p",Jt,g(Q.value??"Unavailable"),1)])]),P.value==="filename_invalid"?(u(),v("p",Wt," Filename strategy requires all files to start with a numeric prefix (for example: 01.jpg). ")):_("",!0),s("ul",Zt,[(u(!0),v(R,null,J(F.value,d=>(u(),v("li",{key:d.fileKey,class:"flex items-start gap-2 rounded border border-border/50 bg-background px-2 py-2"},[s("div",Xt,[s("p",Yt,g(d.fileName),1),s("p",Qt,g(d.fileSizeText),1)]),s("div",ea,[s("p",ta,g(d.targetPageNo===null?"N/A":`Page ${d.targetPageNo}`),1),n(e(Pe),{variant:d.replacesExisting?"destructive":"secondary",class:"mt-1"},{default:r(()=>[c(g(d.replacesExisting?"Replace":"New"),1)]),_:2},1032,["variant"])]),n(e(C),{size:"icon-sm",variant:"ghost",disabled:e(f).processing,onClick:h=>$e(d.fileKey)},{default:r(()=>[n(e(xt),{class:"size-4"}),a[19]||(a[19]=s("span",{class:"sr-only"},"Remove file",-1))]),_:1},8,["disabled","onClick"])]))),128))])])):_("",!0),Te.value.length>0?(u(),M(e(we),{key:5,variant:"destructive"},{default:r(()=>[n(e(Fe),{class:"size-4"}),n(e(Ce),null,{default:r(()=>[...a[20]||(a[20]=[c("Upload failed",-1)])]),_:1}),n(e(De),null,{default:r(()=>[s("ul",aa,[(u(!0),v(R,null,J(Te.value,d=>(u(),v("li",{key:d},g(d),1))),128))])]),_:1})]),_:1})):_("",!0),e(f).progress?(u(),v("div",na,[s("div",sa,[s("p",la,[n(e(mt),{class:"size-3.5 animate-spin"}),a[21]||(a[21]=c(" Uploading files ",-1))]),s("p",null,g(he.value)+"%",1)]),s("div",ia,[s("div",{class:"h-full bg-primary transition-all",style:yt({width:`${he.value}%`})},null,4)])])):_("",!0),s("div",ra,[n(e(C),{class:"w-full sm:w-auto",disabled:!Ie.value,onClick:et},{default:r(()=>[e(f).processing?(u(),M(e(mt),{key:0,class:"size-4 animate-spin"})):_("",!0),c(" "+g(qe.value),1)]),_:1},8,["disabled"])])]))}}),da={class:"mx-auto w-full max-w-7xl space-y-5 p-4 sm:p-6"},ua={class:"grid gap-3 md:grid-cols-2 xl:grid-cols-[minmax(0,220px)_minmax(0,320px)_auto] xl:items-end"},ca={class:"space-y-1"},pa={class:"space-y-1"},fa={class:"grid gap-2 sm:grid-cols-1 xl:grid-cols-1"},ma={key:0,class:"text-sm text-muted-foreground"},ga={key:1,class:"text-sm text-destructive"},va={key:2,class:"text-sm text-muted-foreground"},_a={key:0,class:"space-y-4"},xa={key:0,class:"mb-3 text-xs text-muted-foreground"},ba={key:1,class:"mb-3 text-sm text-destructive"},ya={key:2,class:"mb-3 flex flex-wrap items-center gap-2 rounded-md border border-border/70 bg-muted/20 px-3 py-2"},ha={key:1,class:"text-xs text-muted-foreground"},Ea={class:"ml-auto flex flex-wrap gap-2"},$a={key:3,class:"text-sm text-muted-foreground"},ka={key:4,class:"space-y-2"},Sa=["draggable","onDragstart","onDragenter","onDragover","onDrop"],Da={class:"grid gap-3 sm:grid-cols-[140px_minmax(0,1fr)]"},wa=["src","alt"],Ca={class:"space-y-3"},Fa={class:"flex flex-wrap items-center gap-2"},Na={class:"text-sm font-medium"},Pa={class:"space-y-1 text-xs text-muted-foreground"},Ma={class:"font-medium text-foreground"},za={class:"flex flex-wrap gap-2 pt-1"},Ua=["onDragover","onDrop"],Ia={key:0},Ta={key:1},Va={class:"space-y-4"},Ba={class:"space-y-2"},Oa={key:0,class:"text-xs text-destructive"},ja={class:"space-y-2"},Aa={key:0,class:"text-xs text-destructive"},Ra={class:"space-y-4"},La={class:"space-y-2"},Ka={class:"space-y-2"},Ga={key:0,class:"text-xs text-destructive"},qa={class:"space-y-5"},Ha={class:"grid gap-4 sm:grid-cols-[170px_minmax(0,1fr)]"},Ja=["src","alt"],Wa={class:"space-y-3"},Za={class:"space-y-2"},Xa={key:0,class:"text-xs text-destructive"},Ya={class:"space-y-2"},Qa={key:0,class:"text-xs text-destructive"},en={class:"space-y-2 rounded-md border p-3"},tn={key:0,class:"text-xs text-muted-foreground"},an={key:1,class:"text-xs text-destructive"},nn={class:"flex justify-end"},Un=_t({__name:"Manage",props:{selectedDate:{},dateError:{},dateNotice:{},selectedEdition:{},canDeleteSelectedEdition:{type:Boolean},editionsForDate:{},uploadConstraints:{},pages:{},categories:{}},setup(Ke){const m=Ke,S=[{title:"Manage Editions",href:"/admin/editions/manage"}],U=$(m.selectedDate??""),D=$(typeof m.selectedEdition?.id=="number"&&m.selectedEdition.id>0?String(m.selectedEdition.id):"none"),Z=$(!1),A=$(!1),O=$(!1);ae(()=>m.selectedDate,l=>{U.value=l??""}),ae(()=>m.selectedEdition?.id??null,l=>{D.value=typeof l=="number"&&l>0?String(l):"none"});const T=p(()=>m.pages??[]),w=$([]),X=p(()=>m.selectedEdition!==null),f=p(()=>X.value&&m.canDeleteSelectedEdition),Y=p(()=>U.value!==""),ne=p(()=>m.selectedEdition?.id??0),se=$(null),G=$(!1),Me=$(0),le=$(""),V=$(null),L=$(null),K=$(!1),N=$(null),j=$(null),B=$(null),P=p(()=>se.value===null?null:w.value.find(l=>l.id===se.value)??null),b=ue({page_no:1,category_id:null}),z=ue({file:null}),y=ue({edition_id:0,ordered_page_ids:[]}),F=ue({edition_date:"",name:""}),I=ue({name:""}),Q=ue({}),ce=p({get:()=>typeof b.category_id!="number"||!Number.isFinite(b.category_id)||b.category_id<=0?"none":String(b.category_id),set:l=>{if(l==="none"){b.category_id=null;return}const t=Number.parseInt(l,10);b.category_id=Number.isFinite(t)&&t>0?t:null}}),q=p(()=>w.value.length!==T.value.length?!1:w.value.some((l,t)=>l.id!==T.value[t]?.id)),xe=p(()=>V.value!==null),pe=p(()=>{if(j.value===null||y.processing)return!1;const l=T.value.map(o=>o.id).sort((o,x)=>o-x),t=[...j.value].sort((o,x)=>o-x);return l.length!==t.length?!1:l.every((o,x)=>o===t[x])});ae(T,l=>{w.value=[...l].sort((t,o)=>t.page_no-o.page_no)},{immediate:!0});function fe(l){const t=l??Number.NaN;pt.get("/admin/editions/manage",{date:U.value!==""?U.value:void 0,edition_id:Number.isFinite(t)&&t>0?t:void 0},{preserveScroll:!0,preserveState:!0,replace:!0})}function Ge(){if(D.value="none",U.value===""){fe(null);return}fe(null)}function ze(l){let t="none";typeof l=="string"?t=l:(typeof l=="number"||typeof l=="bigint")&&(t=String(l)),D.value=t,fe(t==="none"?null:Number.parseInt(t,10))}function be(){U.value!==""&&(F.reset(),F.clearErrors(),F.edition_date=U.value,Z.value=!0)}function Ue(){U.value!==""&&(F.edition_date=U.value,F.post("/admin/editions",{preserveScroll:!0,onSuccess:()=>{Z.value=!1,F.reset()}}))}function ye(){m.selectedEdition!==null&&(I.reset(),I.clearErrors(),I.name=m.selectedEdition.name??"",A.value=!0)}function Ie(){m.selectedEdition!==null&&I.patch(`/admin/editions/${m.selectedEdition.id}`,{preserveScroll:!0,onSuccess:()=>{A.value=!1}})}function he(){f.value&&(Q.clearErrors(),O.value=!0)}function qe(){m.selectedEdition===null||!f.value||Q.delete(`/admin/editions/${m.selectedEdition.id}`,{preserveScroll:!0,onSuccess:()=>{O.value=!1}})}function Te(l){O.value=l,l||Q.clearErrors()}function ie(l){return typeof l.name=="string"&&l.name.trim()!==""?l.name.trim():`Edition ${l.id}`}function me(l){const t=l.pages_count===1?"page":"pages";return`${ie(l)} | ${l.edition_date} | ${l.status} | ${l.pages_count} ${t}`}function re(){}function He(l,t){const o=[...w.value],x=o.findIndex(tt=>tt.id===l);if(x<0)return!1;let E=Math.max(0,Math.min(t,o.length));const[ut]=o.splice(x,1);return ut===void 0||(x<E&&(E-=1),E=Math.max(0,Math.min(E,o.length)),o.splice(E,0,ut),!o.some((tt,bt)=>tt.id!==w.value[bt]?.id))?!1:(w.value=o,!0)}function Je(l,t){if(y.processing){t.preventDefault();return}V.value=l;const o=w.value.findIndex(x=>x.id===l);L.value=o>=0?o:null,t.dataTransfer!==null&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",String(l)))}function Ee(l,t){V.value===null||y.processing||(t.preventDefault(),L.value=Math.max(0,Math.min(l,w.value.length)),t.dataTransfer!==null&&(t.dataTransfer.dropEffect="move"))}function oe(l,t){const o=t.currentTarget;if(!(o instanceof HTMLElement))return l+1;const x=o.getBoundingClientRect(),E=x.top+x.height/2;return t.clientY<=E?l:l+1}function Ve(l,t){const o=oe(l,t);Ee(o,t)}function ge(l,t){const o=oe(l,t);ve(o,t)}function ve(l,t){if(V.value===null||y.processing)return;t.preventDefault();const o=t.dataTransfer?.getData("text/plain")??"",x=o!==""?Number.parseInt(o,10):V.value;if(x===null||!Number.isFinite(x)){ee();return}const E=He(x,l);ee(),E&&(B.value=null)}function We(){ee()}function ee(){L.value=null,V.value=null}function Be(l){return V.value!==null&&L.value===l}function Ze(){if(!X.value||!q.value)return;B.value=null;const l=T.value.map(t=>t.id);y.edition_id=ne.value,y.ordered_page_ids=w.value.map(t=>t.id),y.post("/admin/pages/reorder",{preserveScroll:!0,preserveState:!0,onSuccess:()=>{j.value=l,B.value="Page order saved."}})}function Xe(){w.value=[...T.value].sort((l,t)=>l.page_no-t.page_no),y.clearErrors("ordered_page_ids"),B.value=null}function Ye(){!X.value||j.value===null||!pe.value||(B.value=null,y.edition_id=ne.value,y.ordered_page_ids=[...j.value],y.post("/admin/pages/reorder",{preserveScroll:!0,preserveState:!0,onSuccess:()=>{j.value=null,B.value="Reverted to the previous order."}}))}function Qe(l){se.value=l.id,b.page_no=l.page_no,b.category_id=typeof l.category_id=="number"&&Number.isFinite(l.category_id)&&l.category_id>0?l.category_id:null,b.clearErrors(),d(),G.value=!0}function $e(){G.value=!1,se.value=null}function et(l){G.value=l,l||(se.value=null)}function i(){P.value!==null&&b.put(`/admin/pages/${P.value.id}`,{preserveScroll:!0,onSuccess:()=>{$e()}})}function a(l){const o=l.target?.files?.[0]??null;z.file=o,le.value=o?.name??""}function d(){z.reset("file"),z.clearErrors(),le.value="",Me.value+=1}function h(){P.value===null||z.file===null||z.put(`/admin/pages/${P.value.id}/replace`,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{d()}})}function k(l){G.value&&P.value?.id===l.id&&$e(),N.value=l,K.value=!0}function H(){if(N.value===null)return;const l=N.value;pt.delete(`/admin/pages/${l.id}`,{preserveScroll:!0,onSuccess:()=>{K.value=!1,N.value=null}})}function Oe(l){K.value=l,l||(N.value=null)}const ke=p(()=>{const l=w.value[0];if(l!==void 0)return`/admin/hotspots?page_id=${l.id}`}),_e=p(()=>{if(m.selectedEdition!==null)return`/admin/editions/publish?date=${m.selectedEdition.edition_date}&edition_id=${m.selectedEdition.id}`}),Se=p(()=>{if(m.selectedEdition!==null)return`/admin/editions/manage?date=${m.selectedEdition.edition_date}&edition_id=${m.selectedEdition.id}`});return ae(K,l=>{l||(N.value=null)}),ae(()=>m.pages,()=>{if(N.value===null)return;m.pages.some(t=>t.id===N.value?.id)||(N.value=null,K.value=!1)}),ae(()=>ne.value,()=>{j.value=null,B.value=null,y.clearErrors("ordered_page_ids"),A.value=!1,I.reset(),I.clearErrors(),O.value=!1,Q.clearErrors()}),ae(pe,l=>{l||j.value===null||(j.value=null)}),ae(G,l=>{l||(b.clearErrors(),d())}),(l,t)=>(u(),v(R,null,[n(e(ht),{title:"Manage Editions"}),n(kt,{breadcrumbs:S},{default:r(()=>[s("div",da,[t[50]||(t[50]=s("div",{class:"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between"},[s("div",{class:"space-y-1"},[s("h1",{class:"text-2xl font-semibold tracking-tight"},"Manage Pages"),s("p",{class:"text-sm text-muted-foreground"}," Search by edition date, upload pages, and maintain ordering and metadata. ")]),s("p",{class:"text-xs text-muted-foreground"}," Drag to reorder, then save explicitly. ")],-1)),n(e(at),{class:"border-border/70"},{default:r(()=>[n(e(gt),{class:"pb-2"},{default:r(()=>[n(e(vt),null,{default:r(()=>[...t[12]||(t[12]=[c("Select date and edition",-1)])]),_:1})]),_:1}),n(e(nt),{class:"space-y-3"},{default:r(()=>[s("div",ua,[s("div",ca,[t[13]||(t[13]=s("label",{for:"manage-edition-date",class:"text-xs font-medium uppercase tracking-wide text-muted-foreground"}," Edition date ",-1)),n(e(de),{id:"manage-edition-date",modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=o=>U.value=o),type:"date",onChange:Ge},null,8,["modelValue"])]),s("div",pa,[t[15]||(t[15]=s("label",{class:"text-xs font-medium uppercase tracking-wide text-muted-foreground"}," Edition ",-1)),n(e(je),{"model-value":D.value,"onUpdate:modelValue":ze},{default:r(()=>[n(e(Ae),{disabled:!Y.value},{default:r(()=>[n(e(Re),{placeholder:"Select edition"})]),_:1},8,["disabled"]),n(e(Le),null,{default:r(()=>[n(e(W),{value:"none"},{default:r(()=>[...t[14]||(t[14]=[c("Select an edition",-1)])]),_:1}),(u(!0),v(R,null,J(m.editionsForDate,o=>(u(),M(e(W),{key:o.id,value:String(o.id)},{default:r(()=>[c(g(me(o)),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),s("div",fa,[n(e(C),{class:"w-full md:w-auto xl:min-w-28",variant:"outline",disabled:!Y.value,onClick:be},{default:r(()=>[...t[16]||(t[16]=[c(" Create new edition ",-1)])]),_:1},8,["disabled"]),n(e(C),{class:"w-full md:w-auto xl:min-w-28",variant:"secondary",disabled:!X.value,onClick:ye},{default:r(()=>[...t[17]||(t[17]=[c(" Edit edition name ",-1)])]),_:1},8,["disabled"]),n(e(C),{class:"w-full md:w-auto xl:min-w-28",variant:"destructive",disabled:!f.value||e(Q).processing,onClick:he},{default:r(()=>[...t[18]||(t[18]=[c(" Delete edition ",-1)])]),_:1},8,["disabled"])])]),Y.value?_("",!0):(u(),v("p",ma," Pick a date to load available editions. ")),m.dateError?(u(),v("p",ga,g(m.dateError),1)):_("",!0),m.dateNotice?(u(),v("p",va,g(m.dateNotice),1)):_("",!0)]),_:1})]),_:1}),X.value?(u(),v("div",_a,[m.selectedEdition?(u(),M(Et,{key:0,"edition-id":m.selectedEdition.id,"edition-date":m.selectedEdition.edition_date,"edition-name":m.selectedEdition.name,status:m.selectedEdition.status,"pages-count":w.value.length,"published-at":m.selectedEdition.published_at,"manage-href":Se.value,"publish-href":_e.value,"mapping-href":ke.value},null,8,["edition-id","edition-date","edition-name","status","pages-count","published-at","manage-href","publish-href","mapping-href"])):_("",!0),n(oa,{"edition-id":ne.value,categories:m.categories,"upload-constraints":m.uploadConstraints,"existing-page-numbers":w.value.map(o=>o.page_no),onUploaded:re},null,8,["edition-id","categories","upload-constraints","existing-page-numbers"]),n(e(at),{class:"border-border/70"},{default:r(()=>[n(e(gt),{class:"pb-2"},{default:r(()=>[n(e(vt),{class:"flex flex-wrap items-center gap-2"},{default:r(()=>[t[19]||(t[19]=s("span",null,"Uploaded pages",-1)),n(e(Pe),{variant:"secondary"},{default:r(()=>[c(g(w.value.length),1)]),_:1})]),_:1})]),_:1}),n(e(nt),null,{default:r(()=>[t[28]||(t[28]=s("p",{class:"mb-3 text-xs text-muted-foreground"}," Use the drag handle to reorder pages. Save changes when you are ready. ",-1)),e(y).processing?(u(),v("p",xa," Saving order... ")):_("",!0),e(y).errors.ordered_page_ids?(u(),v("p",ba,g(e(y).errors.ordered_page_ids),1)):_("",!0),q.value||pe.value||B.value?(u(),v("div",ya,[q.value?(u(),M(e(Pe),{key:0,variant:"secondary"},{default:r(()=>[...t[20]||(t[20]=[c(" Unsaved order changes ",-1)])]),_:1})):B.value?(u(),v("p",ha,g(B.value),1)):_("",!0),s("div",Ea,[q.value?(u(),M(e(C),{key:0,size:"sm",disabled:e(y).processing,onClick:Ze},{default:r(()=>[...t[21]||(t[21]=[c(" Save order ",-1)])]),_:1},8,["disabled"])):_("",!0),q.value?(u(),M(e(C),{key:1,size:"sm",variant:"outline",disabled:e(y).processing,onClick:Xe},{default:r(()=>[...t[22]||(t[22]=[c(" Cancel changes ",-1)])]),_:1},8,["disabled"])):_("",!0),!q.value&&pe.value?(u(),M(e(C),{key:2,size:"sm",variant:"outline",disabled:e(y).processing,onClick:Ye},{default:r(()=>[...t[23]||(t[23]=[c(" Undo last save ",-1)])]),_:1},8,["disabled"])):_("",!0)])])):_("",!0),w.value.length===0?(u(),v("div",$a," No pages uploaded for this edition yet. ")):(u(),v("div",ka,[s("div",{class:Ne(["rounded-md transition-colors",Be(0)?"h-2 bg-primary/45":xe.value?"h-2 bg-muted/60":"h-1 bg-transparent"]),onDragover:t[1]||(t[1]=o=>Ee(0,o)),onDrop:t[2]||(t[2]=o=>ve(0,o))},null,34),(u(!0),v(R,null,J(w.value,(o,x)=>(u(),v(R,{key:o.id},[s("article",{class:Ne(["group rounded-xl border border-border/70 bg-card p-3 transition-shadow hover:shadow-sm",V.value===o.id?"opacity-60":""]),draggable:!e(y).processing,onDragstart:E=>Je(o.id,E),onDragend:We,onDragenter:E=>Ve(x,E),onDragover:E=>Ve(x,E),onDrop:E=>ge(x,E)},[s("div",Da,[s("img",{src:o.image_thumb_url,alt:`Page ${o.page_no}`,class:"aspect-[3/4] w-full rounded-md border border-border/60 object-cover",draggable:"false",loading:"lazy"},null,8,wa),s("div",Ca,[s("div",Fa,[s("p",Na,"Page "+g(o.page_no),1),n(e(Pe),{variant:"outline",class:"text-[11px]"},{default:r(()=>[c(" Position "+g(x+1),1)]),_:2},1024),s("span",{class:Ne(["ml-auto inline-flex select-none items-center gap-1 rounded border border-border px-2 py-0.5 text-[11px] text-muted-foreground",e(y).processing?"cursor-not-allowed opacity-50":"cursor-grab hover:bg-muted active:cursor-grabbing"])},[n(e(St),{class:"size-3.5"}),t[24]||(t[24]=c(" Drag ",-1))],2)]),s("div",Pa,[s("p",null,[t[25]||(t[25]=c(" Category: ",-1)),s("span",Ma,g(o.category_name??"Uncategorized"),1)]),s("p",null,g(o.width)+" x "+g(o.height),1)]),s("div",za,[n(e(C),{variant:"outline",size:"sm",class:"flex-1 sm:flex-none",onClick:E=>Qe(o)},{default:r(()=>[n(e($t),{class:"size-4"}),t[26]||(t[26]=c(" Edit ",-1))]),_:1},8,["onClick"]),n(e(C),{variant:"destructive",size:"sm",class:"flex-1 sm:flex-none",onClick:E=>k(o)},{default:r(()=>[n(e(xt),{class:"size-4"}),t[27]||(t[27]=c(" Delete ",-1))]),_:1},8,["onClick"])])])])],42,Sa),s("div",{class:Ne(["rounded-md transition-colors",Be(x+1)?"h-2 bg-primary/45":xe.value?"h-2 bg-muted/60":"h-1 bg-transparent"]),onDragover:E=>Ee(x+1,E),onDrop:E=>ve(x+1,E)},null,42,Ua)],64))),128))]))]),_:1})]),_:1})])):(u(),M(e(at),{key:1},{default:r(()=>[n(e(nt),{class:"py-6 text-sm text-muted-foreground"},{default:r(()=>[Y.value?(u(),v("p",Ta," Select an edition for "+g(U.value)+" or create a new one. ",1)):(u(),v("p",Ia," Select a date to load editions. "))]),_:1})]),_:1})),n(e(st),{open:Z.value,"onUpdate:open":t[6]||(t[6]=o=>Z.value=o)},{default:r(()=>[n(e(lt),{class:"sm:max-w-lg"},{default:r(()=>[n(e(it),null,{default:r(()=>[n(e(rt),null,{default:r(()=>[...t[29]||(t[29]=[c("Create new edition",-1)])]),_:1}),n(e(ot),null,{default:r(()=>[c(" This creates a new draft edition for "+g(U.value)+". ",1)]),_:1})]),_:1}),s("div",Va,[s("div",Ba,[t[30]||(t[30]=s("label",{class:"text-sm font-medium",for:"create-edition-date"}," Edition date ",-1)),n(e(de),{id:"create-edition-date",modelValue:e(F).edition_date,"onUpdate:modelValue":t[3]||(t[3]=o=>e(F).edition_date=o),type:"date",disabled:""},null,8,["modelValue"]),e(F).errors.edition_date?(u(),v("p",Oa,g(e(F).errors.edition_date),1)):_("",!0)]),s("div",ja,[t[31]||(t[31]=s("label",{class:"text-sm font-medium",for:"create-edition-name"}," Name (optional) ",-1)),n(e(de),{id:"create-edition-name",modelValue:e(F).name,"onUpdate:modelValue":t[4]||(t[4]=o=>e(F).name=o),type:"text",maxlength:"150",placeholder:"Morning Edition"},null,8,["modelValue"]),t[32]||(t[32]=s("p",{class:"text-xs text-muted-foreground"},' If empty, a default label like "Edition 42" will be shown. ',-1)),e(F).errors.name?(u(),v("p",Aa,g(e(F).errors.name),1)):_("",!0)])]),n(e(dt),null,{default:r(()=>[n(e(C),{variant:"outline",disabled:e(F).processing,onClick:t[5]||(t[5]=o=>Z.value=!1)},{default:r(()=>[...t[33]||(t[33]=[c(" Cancel ",-1)])]),_:1},8,["disabled"]),n(e(C),{disabled:e(F).processing||!Y.value,onClick:Ue},{default:r(()=>[...t[34]||(t[34]=[c(" Create edition ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),n(e(st),{open:A.value,"onUpdate:open":t[9]||(t[9]=o=>A.value=o)},{default:r(()=>[n(e(lt),{class:"sm:max-w-lg"},{default:r(()=>[n(e(it),null,{default:r(()=>[n(e(rt),null,{default:r(()=>[...t[35]||(t[35]=[c("Edit edition name",-1)])]),_:1}),n(e(ot),null,{default:r(()=>[...t[36]||(t[36]=[c(" Update the name shown for this edition. ",-1)])]),_:1})]),_:1}),s("div",Ra,[s("div",La,[t[37]||(t[37]=s("label",{class:"text-sm font-medium",for:"edit-edition-date"}," Edition date ",-1)),n(e(de),{id:"edit-edition-date","model-value":m.selectedEdition?.edition_date??"",type:"date",disabled:""},null,8,["model-value"])]),s("div",Ka,[t[38]||(t[38]=s("label",{class:"text-sm font-medium",for:"edit-edition-name"}," Name (optional) ",-1)),n(e(de),{id:"edit-edition-name",modelValue:e(I).name,"onUpdate:modelValue":t[7]||(t[7]=o=>e(I).name=o),type:"text",maxlength:"150",placeholder:"Morning Edition"},null,8,["modelValue"]),t[39]||(t[39]=s("p",{class:"text-xs text-muted-foreground"}," Leave blank to use the default label. ",-1)),e(I).errors.name?(u(),v("p",Ga,g(e(I).errors.name),1)):_("",!0)])]),n(e(dt),null,{default:r(()=>[n(e(C),{variant:"outline",disabled:e(I).processing,onClick:t[8]||(t[8]=o=>A.value=!1)},{default:r(()=>[...t[40]||(t[40]=[c(" Cancel ",-1)])]),_:1},8,["disabled"]),n(e(C),{disabled:e(I).processing||!X.value,onClick:Ie},{default:r(()=>[...t[41]||(t[41]=[c(" Save name ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),n(e(st),{open:G.value,"onUpdate:open":et},{default:r(()=>[n(e(lt),{class:"sm:max-w-2xl"},{default:r(()=>[n(e(it),null,{default:r(()=>[n(e(rt),null,{default:r(()=>[c(" Edit page "+g(P.value?.page_no??"-"),1)]),_:1}),n(e(ot),null,{default:r(()=>[...t[42]||(t[42]=[c(" Update page metadata, then optionally replace the uploaded image. ",-1)])]),_:1})]),_:1}),s("div",qa,[s("div",Ha,[P.value?(u(),v("img",{key:0,src:P.value.image_thumb_url,alt:`Page ${P.value.page_no}`,class:"aspect-[3/4] w-full rounded-md border object-cover"},null,8,Ja)):_("",!0),s("div",Wa,[s("div",Za,[t[43]||(t[43]=s("label",{class:"text-sm font-medium",for:"manage-page-no"},"Page number",-1)),n(e(de),{id:"manage-page-no",modelValue:e(b).page_no,"onUpdate:modelValue":t[10]||(t[10]=o=>e(b).page_no=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"]),e(b).errors.page_no?(u(),v("p",Xa,g(e(b).errors.page_no),1)):_("",!0)]),s("div",Ya,[t[45]||(t[45]=s("label",{class:"text-sm font-medium"},"Category",-1)),n(e(je),{modelValue:ce.value,"onUpdate:modelValue":t[11]||(t[11]=o=>ce.value=o)},{default:r(()=>[n(e(Ae),null,{default:r(()=>[n(e(Re),{placeholder:"Select category"})]),_:1}),n(e(Le),null,{default:r(()=>[n(e(W),{value:"none"},{default:r(()=>[...t[44]||(t[44]=[c("Uncategorized",-1)])]),_:1}),(u(!0),v(R,null,J(m.categories,o=>(u(),M(e(W),{key:o.id,value:String(o.id)},{default:r(()=>[c(g(o.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(b).errors.category_id?(u(),v("p",Qa,g(e(b).errors.category_id),1)):_("",!0)]),n(e(C),{disabled:e(b).processing,onClick:i},{default:r(()=>[...t[46]||(t[46]=[c(" Save changes ",-1)])]),_:1},8,["disabled"])])]),s("div",en,[t[48]||(t[48]=s("p",{class:"text-sm font-medium"},"Replace page image",-1)),(u(),M(e(de),{key:Me.value,type:"file",accept:".jpg,.jpeg,.png,.webp,image/jpeg,image/png,image/webp",onChange:a})),le.value!==""?(u(),v("p",tn," Selected: "+g(le.value),1)):_("",!0),e(z).errors.file?(u(),v("p",an,g(e(z).errors.file),1)):_("",!0),s("div",nn,[n(e(C),{variant:"outline",disabled:e(z).processing||e(z).file===null,onClick:h},{default:r(()=>[...t[47]||(t[47]=[c(" Replace image ",-1)])]),_:1},8,["disabled"])])])]),n(e(dt),null,{default:r(()=>[n(e(C),{variant:"outline",onClick:$e},{default:r(()=>[...t[49]||(t[49]=[c(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),n(ft,{open:K.value,title:"Delete page?",description:N.value===null?"This also removes related hotspots.":`Delete page ${N.value.page_no}? This also removes related hotspots.`,"confirm-text":"Delete","confirm-variant":"destructive","onUpdate:open":Oe,onConfirm:H},null,8,["open","description"]),n(ft,{open:O.value,title:"Delete edition?",description:m.selectedEdition===null?"This edition and all uploaded pages will be deleted.":`Delete ${ie(m.selectedEdition)} on ${m.selectedEdition.edition_date}? This deletes all uploaded pages and hotspots for this edition.`,"confirm-text":"Delete edition","confirm-variant":"destructive",processing:e(Q).processing,"onUpdate:open":Te,onConfirm:qe},null,8,["open","description","processing"])])]),_:1})],64))}});export{Un as default};
