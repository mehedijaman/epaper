import{d as je,o as i,c as m,G as gs,f as e,H as vs,r as _s,I as Z,e as t,h as xs,w as o,a as r,J as a,K as u,F as b,L as y,j as h,k as U,x as k,p as g,M as ge,N as bs}from"./app-pbFrJQ1g.js";import{_ as w}from"./InputError.vue_vue_type_script_setup_true_lang-C-HT8cHr.js";import{_ as v}from"./index-Baww2-Ur.js";import{_ as f}from"./index-C7XH55Ot.js";import{_ as E,a as V,b as A,c as M}from"./CardTitle.vue_vue_type_script_setup_true_lang-BviJR3X9.js";import{_ as q}from"./Checkbox.vue_vue_type_script_setup_true_lang-DfuDBMjO.js";import{_ as ee,a as se,b as te,c as le,d as oe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-g7g98qn6.js";import{_ as ne}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BzOfP_qh.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-usT0mv6o.js";import{_ as ys,a as ks,b as Me,c as H,d as J}from"./TableRow.vue_vue_type_script_setup_true_lang-Bc31ZPLv.js";import{_ as Cs}from"./EpAdminLayout.vue_vue_type_script_setup_true_lang-p4ThBxOh.js";import"./Primitive-C8vVXU7w.js";import"./useForwardPropsEmits-vmL0mnr1.js";import"./VisuallyHidden-Bk48DAoD.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./useFormControl-Sj2gakQL.js";import"./RovingFocusGroup-Cxwyt7A6.js";import"./VisuallyHiddenInput-CvzdZLmv.js";import"./check-DcPSa9Jq.js";import"./createLucideIcon-Dlt7ezm_.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-fWq6354L.js";import"./chevron-right-BL-wNo7u.js";import"./newspaper-DOM4mVgu.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BneoCAm3.js";import"./index-7fT0rfcv.js";import"./AlertTitle.vue_vue_type_script_setup_true_lang-BytXgFv1.js";const ws=je({__name:"TableBody",props:{class:{type:[Boolean,null,String,Object,Array]}},setup(T){const $=T;return(N,ve)=>(i(),m("tbody",{"data-slot":"table-body",class:gs(e(vs)("[&_tr:last-child]:border-0",$.class))},[_s(N.$slots,"default")],2))}}),$s={class:"mx-auto w-full max-w-7xl space-y-5 p-4 sm:p-6"},Us={class:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},hs={class:"w-full sm:w-[320px]"},Ss={class:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},Ds={class:"text-2xl font-semibold"},Ps={class:"text-2xl font-semibold"},Rs={class:"text-2xl font-semibold"},Es={class:"text-2xl font-semibold"},Vs={class:"space-y-1"},As={class:"text-sm text-muted-foreground"},Ms={key:0,class:"rounded-lg border border-border/70 bg-card px-4 py-10 text-center text-sm text-muted-foreground"},js={key:1,class:"space-y-3 sm:hidden"},Ns={class:"space-y-0.5"},zs={class:"font-medium"},Ls={class:"text-xs text-muted-foreground"},Os={class:"flex flex-wrap items-center gap-2"},Fs={class:"grid grid-cols-2 gap-2 text-xs text-muted-foreground"},Ts={class:"grid grid-cols-3 gap-2"},Is={key:2,class:"hidden overflow-x-auto rounded-lg border border-border/70 bg-card sm:block"},Bs={class:"space-y-1"},Ks={class:"font-medium"},Ys={class:"text-xs text-muted-foreground"},Gs={class:"flex flex-wrap gap-1.5"},qs={class:"flex justify-end gap-2"},Hs={class:"space-y-1"},Js={key:0,class:"rounded-lg border border-border/70 bg-card px-4 py-10 text-center text-sm text-muted-foreground"},Qs={key:1,class:"grid gap-3 md:grid-cols-2 xl:grid-cols-3"},Ws={class:"flex items-start justify-between gap-2"},Xs={class:"font-medium"},Zs={class:"text-xs text-muted-foreground"},et={class:"flex flex-wrap gap-2 text-xs"},st={class:"flex flex-wrap gap-1"},tt={class:"grid grid-cols-2 gap-2"},lt={class:"space-y-1"},ot={key:0,class:"rounded-lg border border-border/70 bg-card px-4 py-10 text-center text-sm text-muted-foreground"},nt={key:1,class:"grid gap-3 md:grid-cols-2 xl:grid-cols-3"},rt={class:"flex items-start justify-between gap-2"},at={class:"font-medium"},it={class:"text-xs text-muted-foreground"},dt={class:"flex flex-wrap gap-2 text-xs"},ut={class:"grid grid-cols-2 gap-2"},mt={class:"grid gap-4 md:grid-cols-2"},ct={class:"space-y-2"},ft={class:"space-y-2"},pt={class:"grid gap-4 md:grid-cols-2"},gt={class:"space-y-2"},vt={class:"text-sm font-medium"},_t={class:"space-y-2"},xt={class:"grid gap-4 md:grid-cols-[220px_minmax(0,1fr)]"},bt={class:"space-y-2"},yt={class:"space-y-2 rounded-lg border border-border/70 bg-card p-3"},kt={class:"space-y-2"},Ct={class:"flex items-center justify-between"},wt={class:"max-h-[320px] space-y-3 overflow-y-auto rounded-lg border border-border/70 bg-card p-3"},$t={class:"text-xs font-semibold uppercase tracking-wide text-muted-foreground"},Ut={class:"grid gap-2 sm:grid-cols-2"},ht={key:0,class:"text-xs text-muted-foreground"},St={class:"rounded-lg border border-border/70 bg-muted/20 p-3 text-sm"},Dt={class:"font-medium"},Pt={class:"text-xs text-muted-foreground"},Rt={key:0,class:"mt-1 text-xs text-muted-foreground"},Et={class:"grid gap-4 md:grid-cols-[220px_minmax(0,1fr)]"},Vt={class:"space-y-2"},At={class:"space-y-2 rounded-lg border border-border/70 bg-card p-3"},Mt={class:"space-y-2"},jt={class:"flex items-center justify-between"},Nt={class:"max-h-[360px] space-y-3 overflow-y-auto rounded-lg border border-border/70 bg-card p-3"},zt={class:"text-xs font-semibold uppercase tracking-wide text-muted-foreground"},Lt={class:"grid gap-2 sm:grid-cols-2"},Ot={class:"space-y-2"},Ft={key:0,class:"text-xs text-muted-foreground"},Tt={class:"space-y-2"},It={class:"flex items-center justify-between"},Bt={class:"max-h-[340px] space-y-3 overflow-y-auto rounded-lg border border-border/70 bg-card p-3"},Kt={class:"text-xs font-semibold uppercase tracking-wide text-muted-foreground"},Yt={class:"grid gap-2 sm:grid-cols-2"},Gt={class:"space-y-2"},qt={key:0,class:"text-xs text-muted-foreground"},yl=je({__name:"Index",props:{users:{},roles:{},permissions:{}},setup(T){const $=T,N=bs(),ve=[{title:"ACL",href:"/admin/users"}],re=k(""),I=k(!1),B=k(null),ae=k(""),_e=k(""),D=k(!1),z=k("create"),L=k(null),P=k(!1),K=k("create"),O=k(null),R=k(!1),Y=k("create"),F=k(null),_=Z({roles:[],permissions:[]}),c=Z({name:"",email:"",password:"",password_confirmation:"",roles:[],permissions:[]}),p=Z({name:"",permissions:[]}),C=Z({name:""}),S=g(()=>N.props.auth.user?.id??null),Ne=g(()=>N.props.errors?.user??""),ze=g(()=>N.props.errors?.role??""),Le=g(()=>N.props.errors?.permission??""),ie=g(()=>[...$.roles].sort((n,s)=>n.name.localeCompare(s.name))),xe=g(()=>O.value===null?null:ie.value.find(n=>n.id===O.value)??null),de=g(()=>[...$.permissions].sort((n,s)=>n.name.localeCompare(s.name))),Oe=g(()=>$.permissions.map(n=>({name:n.name,label:n.label}))),be=g(()=>F.value===null?null:de.value.find(n=>n.id===F.value)??null),ye=g(()=>xe.value===null?!1:W(xe.value.name)),ke=g(()=>be.value===null?!1:X(be.value.name)),Fe=g(()=>$.users.length),Te=g(()=>$.roles.length),Ie=g(()=>$.permissions.length),ue=g(()=>$.users.filter(n=>n.roles.includes("admin")).length),Be=g(()=>$.users.filter(n=>n.direct_permissions.length>0).length),Q=g(()=>{const n=re.value.trim().toLowerCase();return n===""?$.users:$.users.filter(s=>[s.name,s.email,s.roles.join(" "),s.effective_permissions.join(" ")].join(" ").toLowerCase().includes(n))}),me=g(()=>{const n=new Map;for(const s of Oe.value){const l=s.name.split(".")[0]??"general",d=n.get(l)??[];d.push(s),n.set(l,d)}return Array.from(n.entries()).map(([s,l])=>({key:s,label:Ge(s),items:[...l].sort((d,x)=>d.label.localeCompare(x.label))})).sort((s,l)=>s.label.localeCompare(l.label))}),Ke=g(()=>B.value===null||S.value===null?!1:B.value===S.value),Ye=g(()=>L.value===null||S.value===null?!1:L.value===S.value);function Ge(n){return n.replace(/[._-]+/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,s=>s.toUpperCase())}function W(n){return n==="admin"||n==="operator"}function X(n){return["categories.manage","users.manage","ads.manage","settings.manage","editions.manage"].includes(n)}function Ce(n){B.value=n.id,ae.value=n.name,_e.value=n.email,_.roles=[...n.roles].sort((s,l)=>s.localeCompare(l)),_.permissions=[...n.direct_permissions].sort((s,l)=>s.localeCompare(l)),_.clearErrors(),I.value=!0}function we(){_.processing||(I.value=!1)}function qe(n){if(!n){we();return}I.value=!0}function $e(n,s,l){const d=n==="roles"?_.roles:_.permissions,x=new Set(d);l===!0?x.add(s):x.delete(s);const G=Array.from(x).sort((fe,pe)=>fe.localeCompare(pe));if(n==="roles"){_.roles=G;return}_.permissions=G}function He(n,s){$e("roles",n,s)}function Je(n,s){$e("permissions",n,s)}function Qe(){B.value!==null&&_.put(`/admin/users/${B.value}/acl`,{preserveScroll:!0,onSuccess:()=>{I.value=!1}})}function We(){z.value="create",L.value=null,c.reset(),c.roles=[],c.permissions=[],c.clearErrors(),D.value=!0}function Ue(n){z.value="edit",L.value=n.id,c.name=n.name,c.email=n.email,c.password="",c.password_confirmation="",c.roles=[...n.roles].sort((s,l)=>s.localeCompare(l)),c.permissions=[...n.direct_permissions].sort((s,l)=>s.localeCompare(l)),c.clearErrors(),D.value=!0}function he(){c.processing||(D.value=!1)}function Xe(n){if(!n){he();return}D.value=!0}function Se(n,s,l){const d=n==="roles"?c.roles:c.permissions,x=new Set(d);l===!0?x.add(s):x.delete(s);const G=Array.from(x).sort((fe,pe)=>fe.localeCompare(pe));if(n==="roles"){c.roles=G;return}c.permissions=G}function Ze(n,s){Se("roles",n,s)}function es(n,s){Se("permissions",n,s)}function ss(){if(z.value==="edit"&&L.value!==null){c.put(`/admin/users/accounts/${L.value}`,{preserveScroll:!0,onSuccess:()=>{D.value=!1}});return}c.post("/admin/users/accounts",{preserveScroll:!0,onSuccess:()=>{D.value=!1}})}function ce(n){return!(S.value!==null&&n.id===S.value||n.roles.includes("admin")&&ue.value<=1)}function De(n){if(S.value!==null&&n.id===S.value)return"You cannot delete your own account.";if(n.roles.includes("admin")&&ue.value<=1)return"Cannot delete the last admin user."}function Pe(n){ce(n)&&window.confirm(`Delete user "${n.name}"?`)&&ge.delete(`/admin/users/accounts/${n.id}`,{preserveScroll:!0})}function ts(){K.value="create",O.value=null,p.reset(),p.permissions=[],p.clearErrors(),P.value=!0}function ls(n){K.value="edit",O.value=n.id,p.name=n.name,p.permissions=[...n.permissions].sort((s,l)=>s.localeCompare(l)),p.clearErrors(),P.value=!0}function Re(){p.processing||(P.value=!1)}function os(n){if(!n){Re();return}P.value=!0}function ns(n,s){const l=new Set(p.permissions);s===!0?l.add(n):l.delete(n),p.permissions=Array.from(l).sort((d,x)=>d.localeCompare(x))}function rs(){if(K.value==="edit"&&O.value!==null){p.put(`/admin/users/roles/${O.value}`,{preserveScroll:!0,onSuccess:()=>{P.value=!1}});return}p.post("/admin/users/roles",{preserveScroll:!0,onSuccess:()=>{P.value=!1}})}function Ee(n){return!W(n.name)&&n.users_count===0}function as(n){if(W(n.name))return"System roles cannot be deleted.";if(n.users_count>0)return"Remove this role from all users before deletion."}function is(n){Ee(n)&&window.confirm(`Delete role "${n.name}"?`)&&ge.delete(`/admin/users/roles/${n.id}`,{preserveScroll:!0})}function ds(){Y.value="create",F.value=null,C.reset(),C.clearErrors(),R.value=!0}function us(n){Y.value="edit",F.value=n.id,C.name=n.name,C.clearErrors(),R.value=!0}function Ve(){C.processing||(R.value=!1)}function ms(n){if(!n){Ve();return}R.value=!0}function cs(){if(Y.value==="edit"&&F.value!==null){C.put(`/admin/users/permissions/${F.value}`,{preserveScroll:!0,onSuccess:()=>{R.value=!1}});return}C.post("/admin/users/permissions",{preserveScroll:!0,onSuccess:()=>{R.value=!1}})}function Ae(n){return!X(n.name)&&n.roles_count===0&&n.users_count===0}function fs(n){if(X(n.name))return"System permissions cannot be deleted.";if(n.roles_count>0||n.users_count>0)return"Remove this permission from roles/users before deletion."}function ps(n){Ae(n)&&window.confirm(`Delete permission "${n.name}"?`)&&ge.delete(`/admin/users/permissions/${n.id}`,{preserveScroll:!0})}return(n,s)=>(i(),m(b,null,[t(e(xs),{title:"Access Control"}),t(Cs,{breadcrumbs:ve},{default:o(()=>[r("div",$s,[r("div",Us,[s[7]||(s[7]=r("div",{class:"space-y-1"},[r("h1",{class:"text-2xl font-semibold tracking-tight"},"Access Control"),r("p",{class:"text-sm text-muted-foreground"}," Manage users, roles, and direct permissions for admin panel access. ")],-1)),r("div",hs,[t(e(j),{modelValue:re.value,"onUpdate:modelValue":s[0]||(s[0]=l=>re.value=l),placeholder:"Search by name, email, role, permission..."},null,8,["modelValue"])])]),r("div",Ss,[t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"pb-2"},{default:o(()=>[t(e(A),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>[...s[8]||(s[8]=[a("Users",-1)])]),_:1})]),_:1}),t(e(M),null,{default:o(()=>[r("p",Ds,u(Fe.value),1)]),_:1})]),_:1}),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"pb-2"},{default:o(()=>[t(e(A),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>[...s[9]||(s[9]=[a("Roles",-1)])]),_:1})]),_:1}),t(e(M),null,{default:o(()=>[r("p",Ps,u(Te.value),1)]),_:1})]),_:1}),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"pb-2"},{default:o(()=>[t(e(A),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>[...s[10]||(s[10]=[a("Permissions",-1)])]),_:1})]),_:1}),t(e(M),null,{default:o(()=>[r("p",Rs,u(Ie.value),1)]),_:1})]),_:1}),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"pb-2"},{default:o(()=>[t(e(A),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>[...s[11]||(s[11]=[a("Admins",-1)])]),_:1})]),_:1}),t(e(M),null,{default:o(()=>[r("p",Es,u(ue.value),1)]),_:1})]),_:1})]),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"flex flex-col gap-2 pb-3 sm:flex-row sm:items-center sm:justify-between"},{default:o(()=>[r("div",Vs,[t(e(A),{class:"text-base"},{default:o(()=>[...s[12]||(s[12]=[a("User Access",-1)])]),_:1}),r("p",As," Users with direct permissions: "+u(Be.value),1)]),t(e(f),{onClick:We},{default:o(()=>[...s[13]||(s[13]=[a("Create User",-1)])]),_:1})]),_:1}),t(e(M),{class:"space-y-4"},{default:o(()=>[t(w,{message:Ne.value},null,8,["message"]),Q.value.length===0?(i(),m("div",Ms," No users match your current search. ")):(i(),m("div",js,[(i(!0),m(b,null,y(Q.value,l=>(i(),m("article",{key:l.id,class:"space-y-3 rounded-lg border border-border/70 bg-card p-4"},[r("div",Ns,[r("p",zs,u(l.name),1),r("p",Ls,u(l.email),1)]),r("div",Os,[(i(!0),m(b,null,y(l.roles,d=>(i(),h(e(v),{key:`${l.id}-role-${d}`,variant:"default"},{default:o(()=>[a(u(d),1)]),_:2},1024))),128)),l.roles.length===0?(i(),h(e(v),{key:0,variant:"secondary"},{default:o(()=>[...s[14]||(s[14]=[a(" No role ",-1)])]),_:1})):U("",!0)]),r("div",Fs,[r("p",null,"Direct: "+u(l.direct_permissions.length),1),r("p",null,"Effective: "+u(l.effective_permissions.length),1)]),r("div",Ts,[t(e(f),{size:"sm",variant:"outline",onClick:d=>Ce(l)},{default:o(()=>[...s[15]||(s[15]=[a(" ACL ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"outline",onClick:d=>Ue(l)},{default:o(()=>[...s[16]||(s[16]=[a(" Edit ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"destructive",disabled:!ce(l),title:De(l),onClick:d=>Pe(l)},{default:o(()=>[...s[17]||(s[17]=[a(" Delete ",-1)])]),_:1},8,["disabled","title","onClick"])])]))),128))])),Q.value.length>0?(i(),m("div",Is,[t(e(ys),null,{default:o(()=>[t(e(ks),null,{default:o(()=>[t(e(Me),null,{default:o(()=>[t(e(H),{class:"min-w-[240px]"},{default:o(()=>[...s[18]||(s[18]=[a("User",-1)])]),_:1}),t(e(H),{class:"min-w-[220px]"},{default:o(()=>[...s[19]||(s[19]=[a("Roles",-1)])]),_:1}),t(e(H),null,{default:o(()=>[...s[20]||(s[20]=[a("Direct Permissions",-1)])]),_:1}),t(e(H),null,{default:o(()=>[...s[21]||(s[21]=[a("Effective Permissions",-1)])]),_:1}),t(e(H),{class:"text-right"},{default:o(()=>[...s[22]||(s[22]=[a("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(ws),null,{default:o(()=>[(i(!0),m(b,null,y(Q.value,l=>(i(),h(e(Me),{key:l.id},{default:o(()=>[t(e(J),null,{default:o(()=>[r("div",Bs,[r("p",Ks,u(l.name),1),r("p",Ys,u(l.email),1)])]),_:2},1024),t(e(J),null,{default:o(()=>[r("div",Gs,[(i(!0),m(b,null,y(l.roles,d=>(i(),h(e(v),{key:`${l.id}-desktop-role-${d}`,variant:"default"},{default:o(()=>[a(u(d),1)]),_:2},1024))),128)),l.roles.length===0?(i(),h(e(v),{key:0,variant:"secondary"},{default:o(()=>[...s[23]||(s[23]=[a(" No role ",-1)])]),_:1})):U("",!0)])]),_:2},1024),t(e(J),null,{default:o(()=>[t(e(v),{variant:"outline"},{default:o(()=>[a(u(l.direct_permissions.length),1)]),_:2},1024)]),_:2},1024),t(e(J),null,{default:o(()=>[t(e(v),{variant:"outline"},{default:o(()=>[a(u(l.effective_permissions.length),1)]),_:2},1024)]),_:2},1024),t(e(J),{class:"text-right"},{default:o(()=>[r("div",qs,[t(e(f),{size:"sm",variant:"outline",onClick:d=>Ce(l)},{default:o(()=>[...s[24]||(s[24]=[a(" ACL ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"outline",onClick:d=>Ue(l)},{default:o(()=>[...s[25]||(s[25]=[a(" Edit ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"destructive",disabled:!ce(l),title:De(l),onClick:d=>Pe(l)},{default:o(()=>[...s[26]||(s[26]=[a(" Delete ",-1)])]),_:1},8,["disabled","title","onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):U("",!0)]),_:1})]),_:1}),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"flex flex-col gap-2 pb-3 sm:flex-row sm:items-center sm:justify-between"},{default:o(()=>[r("div",Hs,[t(e(A),{class:"text-base"},{default:o(()=>[...s[27]||(s[27]=[a("Roles",-1)])]),_:1}),s[28]||(s[28]=r("p",{class:"text-sm text-muted-foreground"}," Create and manage role-level permission bundles. ",-1))]),t(e(f),{onClick:ts},{default:o(()=>[...s[29]||(s[29]=[a("Create Role",-1)])]),_:1})]),_:1}),t(e(M),{class:"space-y-4"},{default:o(()=>[t(w,{message:ze.value},null,8,["message"]),ie.value.length===0?(i(),m("div",Js," No roles found. ")):(i(),m("div",Qs,[(i(!0),m(b,null,y(ie.value,l=>(i(),m("article",{key:l.id,class:"space-y-3 rounded-lg border border-border/70 bg-card p-4"},[r("div",Ws,[r("div",null,[r("p",Xs,u(l.label),1),r("p",Zs,u(l.name),1)]),W(l.name)?(i(),h(e(v),{key:0,variant:"secondary"},{default:o(()=>[...s[30]||(s[30]=[a(" System ",-1)])]),_:1})):U("",!0)]),r("div",et,[t(e(v),{variant:"outline"},{default:o(()=>[a("Users "+u(l.users_count),1)]),_:2},1024),t(e(v),{variant:"outline"},{default:o(()=>[a("Permissions "+u(l.permissions.length),1)]),_:2},1024)]),r("div",st,[(i(!0),m(b,null,y(l.permissions.slice(0,4),d=>(i(),h(e(v),{key:`${l.id}-permission-${d}`,variant:"secondary"},{default:o(()=>[a(u(d),1)]),_:2},1024))),128)),l.permissions.length>4?(i(),h(e(v),{key:0,variant:"secondary"},{default:o(()=>[a(" +"+u(l.permissions.length-4)+" more ",1)]),_:2},1024)):U("",!0),l.permissions.length===0?(i(),h(e(v),{key:1,variant:"secondary"},{default:o(()=>[...s[31]||(s[31]=[a(" No permissions ",-1)])]),_:1})):U("",!0)]),r("div",tt,[t(e(f),{size:"sm",variant:"outline",onClick:d=>ls(l)},{default:o(()=>[...s[32]||(s[32]=[a(" Edit ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"destructive",disabled:!Ee(l),title:as(l),onClick:d=>is(l)},{default:o(()=>[...s[33]||(s[33]=[a(" Delete ",-1)])]),_:1},8,["disabled","title","onClick"])])]))),128))]))]),_:1})]),_:1}),t(e(E),{class:"border-border/70"},{default:o(()=>[t(e(V),{class:"flex flex-col gap-2 pb-3 sm:flex-row sm:items-center sm:justify-between"},{default:o(()=>[r("div",lt,[t(e(A),{class:"text-base"},{default:o(()=>[...s[34]||(s[34]=[a("Permissions",-1)])]),_:1}),s[35]||(s[35]=r("p",{class:"text-sm text-muted-foreground"}," Manage permission definitions used in ACL assignments. ",-1))]),t(e(f),{onClick:ds},{default:o(()=>[...s[36]||(s[36]=[a("Create Permission",-1)])]),_:1})]),_:1}),t(e(M),{class:"space-y-4"},{default:o(()=>[t(w,{message:Le.value},null,8,["message"]),de.value.length===0?(i(),m("div",ot," No permissions found. ")):(i(),m("div",nt,[(i(!0),m(b,null,y(de.value,l=>(i(),m("article",{key:l.id,class:"space-y-3 rounded-lg border border-border/70 bg-card p-4"},[r("div",rt,[r("div",null,[r("p",at,u(l.label),1),r("p",it,u(l.name),1)]),X(l.name)?(i(),h(e(v),{key:0,variant:"secondary"},{default:o(()=>[...s[37]||(s[37]=[a(" System ",-1)])]),_:1})):U("",!0)]),r("div",dt,[t(e(v),{variant:"outline"},{default:o(()=>[a("Roles "+u(l.roles_count),1)]),_:2},1024),t(e(v),{variant:"outline"},{default:o(()=>[a("Users "+u(l.users_count),1)]),_:2},1024)]),r("div",ut,[t(e(f),{size:"sm",variant:"outline",onClick:d=>us(l)},{default:o(()=>[...s[38]||(s[38]=[a(" Edit ",-1)])]),_:1},8,["onClick"]),t(e(f),{size:"sm",variant:"destructive",disabled:!Ae(l),title:fs(l),onClick:d=>ps(l)},{default:o(()=>[...s[39]||(s[39]=[a(" Delete ",-1)])]),_:1},8,["disabled","title","onClick"])])]))),128))]))]),_:1})]),_:1})]),t(e(ee),{open:D.value,"onUpdate:open":Xe},{default:o(()=>[t(e(se),{class:"w-[95vw] max-w-4xl"},{default:o(()=>[t(e(te),null,{default:o(()=>[t(e(le),null,{default:o(()=>[a(u(z.value==="create"?"Create User":"Edit User"),1)]),_:1}),t(e(oe),null,{default:o(()=>[...s[40]||(s[40]=[a(" Manage account profile, roles, and direct permissions. ",-1)])]),_:1})]),_:1}),r("div",mt,[r("div",ct,[s[41]||(s[41]=r("label",{class:"text-sm font-medium"},"Name",-1)),t(e(j),{modelValue:e(c).name,"onUpdate:modelValue":s[1]||(s[1]=l=>e(c).name=l),placeholder:"Full name"},null,8,["modelValue"]),t(w,{message:e(c).errors.name},null,8,["message"])]),r("div",ft,[s[42]||(s[42]=r("label",{class:"text-sm font-medium"},"Email",-1)),t(e(j),{modelValue:e(c).email,"onUpdate:modelValue":s[2]||(s[2]=l=>e(c).email=l),type:"email",placeholder:"user@example.com"},null,8,["modelValue"]),t(w,{message:e(c).errors.email},null,8,["message"])])]),r("div",pt,[r("div",gt,[r("label",vt,u(z.value==="create"?"Password":"New Password (optional)"),1),t(e(j),{modelValue:e(c).password,"onUpdate:modelValue":s[3]||(s[3]=l=>e(c).password=l),type:"password",autocomplete:"new-password"},null,8,["modelValue"]),t(w,{message:e(c).errors.password},null,8,["message"])]),r("div",_t,[s[43]||(s[43]=r("label",{class:"text-sm font-medium"},"Confirm Password",-1)),t(e(j),{modelValue:e(c).password_confirmation,"onUpdate:modelValue":s[4]||(s[4]=l=>e(c).password_confirmation=l),type:"password",autocomplete:"new-password"},null,8,["modelValue"])])]),r("div",xt,[r("section",bt,[s[44]||(s[44]=r("h3",{class:"text-sm font-medium"},"Roles",-1)),r("div",yt,[(i(!0),m(b,null,y(T.roles,l=>(i(),m("label",{key:`managed-user-role-${l.id}`,class:"flex cursor-pointer items-center gap-2 text-sm"},[t(e(q),{checked:e(c).roles.includes(l.name),"onUpdate:checked":d=>Ze(l.name,d)},null,8,["checked","onUpdate:checked"]),r("span",null,u(l.label),1)]))),128))]),t(w,{message:e(c).errors.roles},null,8,["message"])]),r("section",kt,[r("div",Ct,[s[45]||(s[45]=r("h3",{class:"text-sm font-medium"},"Direct Permissions",-1)),t(e(v),{variant:"outline"},{default:o(()=>[a(u(e(c).permissions.length)+" selected",1)]),_:1})]),r("div",wt,[(i(!0),m(b,null,y(me.value,l=>(i(),m("section",{key:`managed-user-perm-group-${l.key}`,class:"space-y-2"},[r("p",$t,u(l.label),1),r("div",Ut,[(i(!0),m(b,null,y(l.items,d=>(i(),m("label",{key:`managed-user-permission-${d.name}`,class:"flex cursor-pointer items-center gap-2 text-sm"},[t(e(q),{checked:e(c).permissions.includes(d.name),"onUpdate:checked":x=>es(d.name,x)},null,8,["checked","onUpdate:checked"]),r("span",null,u(d.label),1)]))),128))])]))),128))]),t(w,{message:e(c).errors.permissions},null,8,["message"])])]),Ye.value?(i(),m("p",ht," You are editing your own account. ")):U("",!0),t(e(ne),{class:"gap-2"},{default:o(()=>[t(e(f),{variant:"outline",disabled:e(c).processing,onClick:he},{default:o(()=>[...s[46]||(s[46]=[a(" Cancel ",-1)])]),_:1},8,["disabled"]),t(e(f),{disabled:e(c).processing,onClick:ss},{default:o(()=>[a(u(e(c).processing?"Saving...":z.value==="create"?"Create User":"Save User"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(e(ee),{open:I.value,"onUpdate:open":qe},{default:o(()=>[t(e(se),{class:"w-[95vw] max-w-4xl"},{default:o(()=>[t(e(te),null,{default:o(()=>[t(e(le),null,{default:o(()=>[...s[47]||(s[47]=[a("Manage User ACL",-1)])]),_:1}),t(e(oe),null,{default:o(()=>[a(" Update roles and direct permissions for "+u(ae.value)+". ",1)]),_:1})]),_:1}),r("div",St,[r("p",Dt,u(ae.value),1),r("p",Pt,u(_e.value),1),Ke.value?(i(),m("p",Rt," You are editing your own access. ")):U("",!0)]),r("div",Et,[r("section",Vt,[s[48]||(s[48]=r("h3",{class:"text-sm font-medium"},"Roles",-1)),r("div",At,[(i(!0),m(b,null,y(T.roles,l=>(i(),m("label",{key:`user-role-choice-${l.name}`,class:"flex cursor-pointer items-center gap-2 text-sm"},[t(e(q),{checked:e(_).roles.includes(l.name),"onUpdate:checked":d=>He(l.name,d)},null,8,["checked","onUpdate:checked"]),r("span",null,u(l.label),1)]))),128))]),t(w,{message:e(_).errors.roles},null,8,["message"])]),r("section",Mt,[r("div",jt,[s[49]||(s[49]=r("h3",{class:"text-sm font-medium"},"Direct Permissions",-1)),t(e(v),{variant:"outline"},{default:o(()=>[a(u(e(_).permissions.length)+" selected",1)]),_:1})]),r("div",Nt,[(i(!0),m(b,null,y(me.value,l=>(i(),m("section",{key:`user-perm-group-${l.key}`,class:"space-y-2"},[r("p",zt,u(l.label),1),r("div",Lt,[(i(!0),m(b,null,y(l.items,d=>(i(),m("label",{key:`user-permission-choice-${d.name}`,class:"flex cursor-pointer items-center gap-2 text-sm"},[t(e(q),{checked:e(_).permissions.includes(d.name),"onUpdate:checked":x=>Je(d.name,x)},null,8,["checked","onUpdate:checked"]),r("span",null,u(d.label),1)]))),128))])]))),128))]),t(w,{message:e(_).errors.permissions},null,8,["message"])])]),t(e(ne),{class:"gap-2"},{default:o(()=>[t(e(f),{variant:"outline",disabled:e(_).processing,onClick:we},{default:o(()=>[...s[50]||(s[50]=[a(" Cancel ",-1)])]),_:1},8,["disabled"]),t(e(f),{disabled:e(_).processing,onClick:Qe},{default:o(()=>[a(u(e(_).processing?"Saving...":"Save ACL"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(e(ee),{open:P.value,"onUpdate:open":os},{default:o(()=>[t(e(se),{class:"w-[95vw] max-w-3xl"},{default:o(()=>[t(e(te),null,{default:o(()=>[t(e(le),null,{default:o(()=>[a(u(K.value==="create"?"Create Role":"Edit Role"),1)]),_:1}),t(e(oe),null,{default:o(()=>[...s[51]||(s[51]=[a(" Define role name and permissions. ",-1)])]),_:1})]),_:1}),r("div",Ot,[s[52]||(s[52]=r("label",{class:"text-sm font-medium"},"Role Name",-1)),t(e(j),{modelValue:e(p).name,"onUpdate:modelValue":s[5]||(s[5]=l=>e(p).name=l),placeholder:"e.g. content_manager",disabled:ye.value},null,8,["modelValue","disabled"]),ye.value?(i(),m("p",Ft," System role names cannot be changed. ")):U("",!0),t(w,{message:e(p).errors.name},null,8,["message"])]),r("section",Tt,[r("div",It,[s[53]||(s[53]=r("h3",{class:"text-sm font-medium"},"Permissions",-1)),t(e(v),{variant:"outline"},{default:o(()=>[a(u(e(p).permissions.length)+" selected",1)]),_:1})]),r("div",Bt,[(i(!0),m(b,null,y(me.value,l=>(i(),m("section",{key:`role-perm-group-${l.key}`,class:"space-y-2"},[r("p",Kt,u(l.label),1),r("div",Yt,[(i(!0),m(b,null,y(l.items,d=>(i(),m("label",{key:`role-permission-choice-${d.name}`,class:"flex cursor-pointer items-center gap-2 text-sm"},[t(e(q),{checked:e(p).permissions.includes(d.name),"onUpdate:checked":x=>ns(d.name,x)},null,8,["checked","onUpdate:checked"]),r("span",null,u(d.label),1)]))),128))])]))),128))]),t(w,{message:e(p).errors.permissions},null,8,["message"])]),t(e(ne),{class:"gap-2"},{default:o(()=>[t(e(f),{variant:"outline",disabled:e(p).processing,onClick:Re},{default:o(()=>[...s[54]||(s[54]=[a(" Cancel ",-1)])]),_:1},8,["disabled"]),t(e(f),{disabled:e(p).processing,onClick:rs},{default:o(()=>[a(u(e(p).processing?"Saving...":K.value==="create"?"Create Role":"Save Role"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(e(ee),{open:R.value,"onUpdate:open":ms},{default:o(()=>[t(e(se),{class:"w-[95vw] max-w-xl"},{default:o(()=>[t(e(te),null,{default:o(()=>[t(e(le),null,{default:o(()=>[a(u(Y.value==="create"?"Create Permission":"Edit Permission"),1)]),_:1}),t(e(oe),null,{default:o(()=>[...s[55]||(s[55]=[a(" Define permission key used by roles and user ACL. ",-1)])]),_:1})]),_:1}),r("div",Gt,[s[56]||(s[56]=r("label",{class:"text-sm font-medium"},"Permission Key",-1)),t(e(j),{modelValue:e(C).name,"onUpdate:modelValue":s[6]||(s[6]=l=>e(C).name=l),placeholder:"e.g. reports.manage",disabled:ke.value},null,8,["modelValue","disabled"]),ke.value?(i(),m("p",qt," System permission names cannot be changed. ")):U("",!0),t(w,{message:e(C).errors.name},null,8,["message"])]),t(e(ne),{class:"gap-2"},{default:o(()=>[t(e(f),{variant:"outline",disabled:e(C).processing,onClick:Ve},{default:o(()=>[...s[57]||(s[57]=[a(" Cancel ",-1)])]),_:1},8,["disabled"]),t(e(f),{disabled:e(C).processing,onClick:cs},{default:o(()=>[a(u(e(C).processing?"Saving...":Y.value==="create"?"Create Permission":"Save Permission"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{yl as default};
